function getAddressByZippr(zipper,savedAddress,zipperType,currentObj){"undefined"!=typeof flag&&""!=flag||(flag=!1),showPageBlocker(),$.ajax({type:"get",url:baseurl+"/zippr/getaddressbyzippr",dataType:"json",data:{zipper_code:zipper},success:function(data){var obj=eval(data);if(hidePageBlocker(),1==obj.status){var response=obj.data.result.address,store_code=obj.data.store_code,city=response.city.replace(/ /gi,"-");if("undefined"!=typeof zipperSource&&"primary"==zipperSource)window.location=baseurl+"/menu/D/"+$.trim(city)+"/"+$.trim(response.locality)+"/"+$.trim(store_code);else if("undefined"==typeof zipperSource||"secondary"!=zipperSource||void 0!==zipperType&&""!=zipperType){if(void 0!==zipperType||"updateZipper"==zipperType){var defaultStore="false";void 0===currentObj&&(defaultStore="true");var zipperDetail={selCity:$.trim(response.city),selLocality:$.trim(response.locality),selSubLocality:$.trim(response.sublocality),selArea1:"",selArea2:"",houseNo:$.trim(response.user_aptnum),street:$.trim(response.user_buildingname),addressType:savedAddress.addressType,defaultStore:defaultStore,storeCode:store_code,isZippr:1};hidePageBlocker(),setStore(zipperDetail,currentObj)}}else{var savedAddresses=$.trim($(".savedAddresses").val()),zipprHouse="";void 0!==response.user_aptnum&&""!=$.trim(response.user_aptnum)?zipprHouse=$.trim(response.user_aptnum):void 0!==response.unit_num&&""!=$.trim(response.unit_num)&&(zipprHouse=$.trim(response.unit_num));var zipprStreet="";void 0!==response.road_name&&""!=$.trim(response.road_name)?zipprStreet=$.trim(response.road_name):void 0!==response.user_buildingname&&""!=$.trim(response.user_buildingname)&&(zipprStreet=$.trim(response.user_buildingname));var postData={city:response.city,locality:$.trim(response.locality),subLocality:$.trim(response.sublocality),storeCode:store_code,customLocator:!0,street:zipprStreet,house:zipprHouse,selArea1:"",selArea2:"",myAddressType:"home",csrf_token:csrfToken,totalCount:savedAddresses,zipperCode:zipper};saveOrUpdateAddress(postData,"saveNewAddress")}}else{hidePageBlocker();var error_msg="We could not auto detect your location, please select your location manually.";void 0===obj.message&&(error_msg="This is an invalid Zippr code, kindly enter a valid one or create a new one via the map."),$.prompt(error_msg,{title:"Error !!",buttons:{Ok:!0},submit:function(e,t,r,a){if(!0)return!0}})}},error:function(){return hidePageBlocker(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1}})}function getLocalityForCity(e,t){showPageBlockerForStoreLocator();var r=$.Deferred();$(".ui-autocomplete").hide(),""!=e&&void 0!==e||(e=$("#custCity").val()),completeLocality=!1,""==$(".tagArea").html()&&($(".submitrow").removeClass("active1"),$("#updateAddressBtn").prop("disabled",!0),$("#saveAddressBtn").prop("disabled",!0),completeLocality=!1),"pickup"==t&&(completeLocality=!0),$(".selectLocation").children(".ui-widget").children(".custom-combobox").children(".locality_arrow").css("visibility","visible"),$("#custAddress").prop("readonly",!1);var a=getUrlParameter("src"),s={},i="";return void 0!==a&&"irctc-railways"==a&&(s={"Cache-Control":"max-age=0, public"},i="?type="+a),$.ajax({type:"get",url:baseurl+"/getLocality/"+t+"/"+i,dataType:"json",data:{city_id:e},headers:s,success:function(e){$("#custCity").focus(),$("#custAddress").focus(),hidePageBlockerForStoreLocator(),1==e.status?prepareLocalityHtml(e.data):($.OLOMessages.set(e.message,"Success!"),$.OLOMessages.displayAlert()),r.resolve(e)},error:function(){return hidePageBlockerForStoreLocator(),r.reject(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1}}),r.promise()}function prepareLocalityHtml(e){var t=e,r='<option value="">Select Locality</option>';for(key in t)r+='<option value="'+key+'">'+t[key]+"</option>";$("#combobox_locality").html(r);r=""}function getStoreAddress(e,t){showPageBlockerForStoreLocator();var r=$.Deferred();return $(".submitrow").removeClass("active1"),$("#updateAddressBtn").prop("disabled",!0),$("#saveAddressBtn").prop("disabled",!0),$(".selectLocation").children(".ui-widget").children(".custom-combobox").children(".locality_arrow").css("visibility","visible"),$("#custAddress").prop("readonly",!1),completeLocality=!1,$.ajax({type:"get",url:baseurl+"/getStoreAddress/",dataType:"json",data:{data:t,city_id:e},success:function(e){if($("#buildOrderBtn").focus(),hidePageBlockerForStoreLocator(),1==e.status){if(""==e.data){var t=$(document).find("#combobox_locality").find(":selected").val(),a="";void 0!==t&&(a=t.split("#")[1]),$(".submitrow").addClass("active1"),$("#buildOrderBtn").prop("disabled",!1),$("#updateAddressBtn").prop("disabled",!1),$("#saveAddressBtn").prop("disabled",!1),$("#custAddress").prop("readonly",!0),$(".selectLocation").children(".ui-widget").children(".custom-combobox").children(".locality_arrow").css("visibility","hidden"),completeLocality=!0,$("#custAddress").val("")}if(prepareLocalityHtml(e.data,"address_sub_locality"),""==e.data){var s='<option value="'+selectedAddressValue+"#"+a+'">'+selectedAddressText+"</option>";$("#combobox_locality").html(s),completeLocality=!0}hidePageBlockerForStoreLocator()}else $.OLOMessages.set(e.message,"Success!"),$.OLOMessages.displayAlert();r.resolve(e)},error:function(){return hidePageBlockerForStoreLocator(),r.reject(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1}}),r.promise()}function getLocality(e){var t="home_delivery";orderType="homedelivery",$("#pick-up").is(":checked")&&(t="pick_up",orderType="pickup",completeLocality=!0),cityId=void 0===e?$("#combobox").find(":selected").val():e;var r={locality:"",subLocality:"",area1:""};setTimeout(function(){if("home_delivery"==t){if($(".addressTag").each(function(e){switch(e){case 0:r.locality=$(this).find(".locality_html").html(),selectedAddressValue=r.locality+"^",selectedAddressText=r.locality+" ";break;case 1:r.subLocality=$(this).find(".locality_html").html(),selectedAddressValue+=r.subLocality+"^",selectedAddressText+=r.subLocality+" ";break;case 2:r.area1=$(this).find(".locality_html").html(),selectedAddressValue+=r.area1+"^",selectedAddressText+=r.area1+" ";break;case 3:r.area2=$(this).find(".locality_html").html(),selectedAddressValue+=r.area2+"^",selectedAddressText+=r.area2+" "}}),""!=cityId&&""!=orderType&&""==r.locality)return void getLocalityForCity(cityId,orderType);""!=cityId&&""!=r.locality&&getStoreAddress(cityId,r)}else if("pickup"==orderType&&""!=cityId){getLocalityForCity(cityId,orderType);$("#combobox_locality").find(":selected").val()}},200)}function checkStoreDetail(e,t,r,a,s,i,o,l,d,n){showPageBlocker();var c="",p=$.Deferred(),u={selCity:e,selLocality:t,selSubLocality:r,selArea1:a,selArea2:s};if(""!=e||void 0===e)return $.ajax({type:"POST",url:baseurl+"/getSavedStoreAddress",data:u,cache:!1,dataType:"json",success:function(u){if(1==$.isArray(u)||null!=u){var m=u.new_address.city_name,y=u.new_address.locality_name,h=u.new_address.sub_locality_name,v=u.new_address.area1,f=u.msg;if(c=u.store,""!=m&&"available"!=f){$.prompt("Your Restaurant address has been modified, Please update your selected address.",{title:"Update your selected address!",buttons:{Ok:!0,Cancel:!1},submit:function(a,s,i,o){if(1==s){var d=location.pathname.split("/");if(d=d[1],$("#googleBuildOrder").length){var n=e+" "+t+" "+r;showMapByAddress(n)}else if("menu"==d&&"undefined"!=typeof typeOfOrder&&"P"==typeOfOrder)showPageBlocker(),window.location=baseurl+"/dashboard";else{$("#newAddressForm").append('<input type="hidden" value="'+l+'" name="address_type" id="addressType"/>'),$("#newAddressForm").append('<input type="hidden" value="updateAddress" name="address_type" id="updateAddress"/>');var c='<option value="'+m+'" selected="selected">'+m+"</option>";if($("#address_city").html(c),$("#inputNew1").val(m),$(".addressPopupTitle").html("Update Address"),$("#toggle").click(function(){$("#address_city").toggle()}),"selLocality"==f||"multiple_stores"==f)$.when(getLocalityFromCity(m)).then(function(e){$.when(prepareSelectLocalityHtml(e)).then(function(){$(".addressPopupTitle").html("Update Address"),$("#fade").popup("show")})});else if("selSubLocality"==f)$.when(getLocalityFromCity(m)).then(function(e){$.when(prepareSelectLocalityHtml(e,y)).then(function(){var e={locality:y};$.when(getSubLocality(m,e)).then(function(e){$.when(prepareSelectSubLocalityHtml(e)).then(function(){$(".addressPopupTitle").html("Update Address"),$("#inputNew2").val(y),$("#fade").popup("show")})})})});else if("selArea1"==f)$.when(getLocalityFromCity(m)).then(function(e){prepareSelectLocalityHtml(e,y);var t={locality:y};$.when(getSubLocality(m,t)).then(function(e){prepareSelectSubLocalityHtml(e,h);var t={locality:y,subLocality:h};$.when(getSubLocality(m,t)).then(function(e){$.when(prepareSelectArea1Html(e,v)).then(function(){$(".addressPopupTitle").html("Update Address"),$("#inputNew2").val(y),$("#inputNew3").val(h),$("#fade").popup("show")})})})});else if("selArea2"==f){$.when(getLocalityFromCity(m)).then(function(e){prepareSelectLocalityHtml(e,y)});p={locality:y};$.when(getSubLocality(m,p)).then(function(e){prepareSelectSubLocalityHtml(e,h)});p={locality:y,subLocality:h};$.when(getSubLocality(m,p)).then(function(e){prepareSelectArea1Html(e,v)});var p={locality:y,subLocality:h,area1:v};$.when(getStoreAddress(m,p)).then(function(e){$.when(prepareSelectArea2Html(e)).then(function(){$(".addressPopupTitle").html("Update Address"),$("#inputNew2").val(y),$("#inputNew3").val(h),$("#inputNew4").val(v),$("#fade").popup("show")})})}}}else hidePageBlocker()}})}else if("available"==f&&""!=c&&""!=l&&""!=m){var b="false";void 0===d&&(b="true");var g={storeCode:c,selCity:e,selLocality:t,selSubLocality:r,selArea1:a,selArea2:s,houseNo:i,street:o,addressType:l,defaultStore:b};hidePageBlocker(),void 0!==n&&"default"==n?setStore(g):setStore(g,d)}}else hidePageBlocker();p.resolve()},error:function(){hidePageBlocker()}}),p.promise();hidePageBlocker()}function saveOrUpdateAddress(e,t){showPageBlocker(),$.ajax({url:baseurl+"/"+t,dataType:"json",type:"POST",data:e,success:function(e){if(hidePageBlocker(),!e.status)return void 0===e.message||""==e.message?(hidePageBlocker(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1):($.OLOMessages.set(e.message,"Alert!"),$.OLOMessages.displayAlert(),!1);$.prompt(e.message,{title:"Success!",buttons:{Ok:!0},submit:function(e,t,r,a){1==t&&($("#fade").popup("hide"),showPageBlocker(),location.reload())}})},error:function(){return $("#fade").popup("hide"),hidePageBlocker(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1}})}function showConfirmAlert(e){$.prompt("Your Restaurant address has been modified, Please update your selected address.",{title:"Update your selected address!",buttons:{Ok:!0,Cancel:!1},submit:function(t,r,a,s){1==r&&($("##newAddressForm").append('<input type="hidden" value="'+e+'" name="address_type" id="addressType"/>'),$(".dropListBottom").append('<input type="hidden" value="update" id="updateAddress"/>'),$(".addressPopupTitle").html("Update Address"),$("#fade").popup("show"))}})}function getSubLocality(e,t){showPageBlocker();var r=$.Deferred();return $.ajax({type:"get",url:baseurl+"/getStoreAddress/",dataType:"json",data:{data:t,city_id:e},success:function(e){hidePageBlocker(),r.resolve(e)},error:function(){return hidePageBlocker(),r.reject(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1}}),r.promise()}function getArea1(e,t,r){$.when(getSubLocality(e,t)).then(function(t){if(!t.status)return hidePageBlocker(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1;if(""!=t.data){var a='<option value="">Select Area1</option>';for(var s in t.data)$.trim(t.data[s])==r.area1?a+='<option selected value="'+s+'">'+$.trim(t.data[s])+"</option>":a+='<option value="'+s+'">'+$.trim(t.data[s])+"</option>";if($("#address_area1").length)$("#address_area1").html(a),$("#address_area1").combobox();else{var i='            <li class="area1List">\n              <div class="dropListrow">\n                <label>Select Area1</label>\n                <div class="dropList">\n                  <select name="select" id="address_area1" class="selectpicker">\n                  '+a+"\n                  </select>\n                </div>\n              </div>\n            </li>";if($(".dropListMiddle").children("ul").append(i),$("#address_area1").combobox(),void 0!==r.area1&&""!=r.area1){var o={locality:r.locality,subLocality:r.subLocality,area1:r.area1};getArea2(e,o,r.area2)}}}else appendBottomHtml()})}function getArea2(e,t,r){$.when(getSubLocality(e,t,r)).then(function(e){if(!e.status)return hidePageBlocker(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1;if(""!=e.data){var t='<option value="">Select Area2 </option>';for(var a in e.data)$.trim(e.data[a])==$.trim(r)?t+='<option selected value="'+a+'">'+e.data[a]+"</option>":t+='<option value="'+a+'">'+e.data[a]+"</option>";if($("#address_area2").length)$("#address_area2").html(t),$("#address_area2").combobox();else{var s='            <li class="area2List">\n              <div class="dropListrow">\n                <label>Select Area2</label>\n                <div class="dropList">\n                  <select name="select" id="address_area2" class="selectpicker">\n                  '+t+"\n                  </select>\n                </div>\n              </div>\n            </li>";$(".dropListMiddle").children("ul").append(s),$("#address_area2").combobox(),void 0!==r&&""!=r&&appendBottomHtml()}}else appendBottomHtml()})}function appendBottomHtml(){$(".dropListMiddle").children("ul").append('  <li class="address_street">\n      <div class="dropListrow">\n        <label>Street/Society name</label>\n        <div class="dropList">\n          <input type="text" id="address_street" name="text" value="" placeholder="Type Street/Society name" maxlength="50">\n        </div>\n      </div>\n    </li>\n    <li class="address_house">\n      <div class="dropListrow">\n        <label>Flat/House Number</label>\n        <div class="dropList">\n          <input type="text" id="address_house" name="text" value="" placeholder="Type Flat/House Number" maxlength="10">\n        </div>\n      </div>\n    </li>');$(".dropListMiddle .drRow").append('  <li class="homeOrOffice">\n      <div class="dropListrow">\n          <label>My</label>\n          <div class="dropList">\n              <select id="homeOrOffice">\n                  <option value="Home">Home</option>\n                  <option value="Office">Office</option>\n               </select>\n          </div>\n      </div>\n  </li>'),$(".dropListBottom").html('<input type="submit" name="submit" id="submitAddress" value="SUBMIT">')}function getLocalityFromCity(e){showPageBlocker();var t=$.Deferred();return $.ajax({type:"get",url:baseurl+"/getLocality/homedelivery/",dataType:"json",data:{city_id:e},success:function(e){if(hidePageBlocker(),1!=e.status)return t.reject(e),$.OLOMessages.set(e.message,"Success!"),$.OLOMessages.displayAlert(),!1;t.resolve(e)},error:function(){return t.reject(resp),hidePageBlocker(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1}}),t.promise()}function getCitiesForHomeDelivery(){var e=new $.Deferred;return showPageBlocker(),$.ajax({url:baseurl+"/getCities",dataType:"json",Type:"GET",success:function(t){hidePageBlocker(),e.resolve(t)},error:function(t){hidePageBlocker(),e.reject(t)}}),e.promise()}function prepareSelectLocalityHtml(e,t){if(!e.status)return hidePageBlocker(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1;var r='<option value="">Select Locality</option>';for(var a in e.data)$.trim(e.data[a])==t?r+='<option selected="selected" value="'+a+'">'+e.data[a]+"</option>":r+='<option value="'+a+'">'+e.data[a]+"</option>";if($("#address_locality").length)$("#address_locality").html(r);else{var s='        <li class="localityList">\n          <div class="dropListrow">\n            <label>Select a locality</label>\n            <div class="dropList">\n              <select class="selectpicker" name="select" id="address_locality">\n"'+r+'"\n              </select>\n            </div>\n          </div>\n        </li>';$(".dropListTop").children(".drRow").append(s),$("#address_locality").combobox()}}function prepareSelectSubLocalityHtml(e,t){if(!e.status)return hidePageBlocker(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1;var r='<option value="">Select a Sub Locality</option>';for(var a in e.data)$.trim(e.data[a])==t?r+='<option selected="selected" value="'+a+'">'+$.trim(e.data[a])+"</option>":r+='<option value="'+a+'">'+$.trim(e.data[a])+"</option>";if($("#address_sub_locality").length)$("#address_sub_locality").html(r);else{var s='        <ul class="drRow">\n          <li class="subLocalityList">\n            <div class="dropListrow">\n              <label>Select a Sub Locality</label>\n              <div class="dropList">\n                <select name="select" id="address_sub_locality" class="selectpicker">\n                '+r+"\n                </select>\n              </div>\n            </div>\n          </li>\n        </ul>";$(".dropListMiddle").html(s),$("#address_sub_locality").combobox()}}function prepareSelectArea1Html(e,t){if(!e.status)return hidePageBlocker(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1;if(""!=e.data){var r='<option value="">Select Area1</option>';for(var a in e.data)e.data[a]==t?r+='<option selected="selected" value="'+a+'">'+$.trim(e.data[a])+"</option>":r+='<option value="'+a+'">'+$.trim(e.data[a])+"</option>";if($("#address_area1").length)$("#address_area1").html(r);else{var s='        <li class="area1List">\n          <div class="dropListrow">\n            <label>Select Area1</label>\n            <div class="dropList">\n              <select name="select" id="address_area1" class="selectpicker">\n              '+r+"\n              </select>\n            </div>\n          </div>\n        </li>";$(".dropListMiddle").children("ul").append(s),$("#address_area1").combobox()}}}function prepareSelectArea2Html(e){if(!e.status)return hidePageBlocker(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1;if(""!=e.data){var t='<option value="">Select Area2</option>';for(var r in e.data)t+='<option value="'+r+'">'+$.trim(e.data[r])+"</option>";if($("#address_area2").length)$("#address_area2").html(t);else var a='        <li class="area2List">\n          <div class="dropListrow">\n            <label>Select Area2</label>\n            <div class="dropList">\n              <select name="select" id="address_area2" class="selectpicker">\n              '+t+"\n              </select>\n            </div>\n          </div>\n        </li>";$(".dropListMiddle").children("ul").append(a),$("#address_area2").combobox()}}function onAddressCityChange(e){$(".dropListMiddle").html(""),$("#address_locality").length&&$(".localityList").remove(),$("#address_sub_locality").length&&$(".subLocalityList").remove(),$("#address_area1").length&&$(".area1List").remove(),$(".dropListMap").addClass("hide"),$(".zipprDrop").addClass("hide"),$(".dropListBottom").html(""),""!==e&&(showPageBlocker(),$.ajax({type:"get",url:baseurl+"/getLocality/homedelivery/",dataType:"json",data:{city_id:e},success:function(e){if(hidePageBlocker(),1!=e.status)return $.OLOMessages.set(e.message,"Alert!"),$.OLOMessages.displayAlert(),!1;if(""!=e.data||null!=e.data){var t='<option value="">Select Locality</option>';for(var r in e.data)t+='<option value="'+r+'">'+e.data[r]+"</option>";if($("#address_locality").length)$("#address_locality").html(t);else{var a='<li class="localityList">\n                  <div class="dropListrow">\n                    <label>Select a locality</label>\n                    <div class="dropList">\n                      <select name="select" id="address_locality" class="selectpicker">\n"'+t+'"\n                      </select>\n                    </div>\n                  </div></li>';$(".dropListTop").children(".drRow").append(a),$("#address_locality").combobox()}$(".dropListMap").addClass("hide"),$(".dropListBottom").html("")}else $(".dropListMiddle").html("");hidePageBlocker()},error:function(){return hidePageBlocker(),$.prompt("We regret some technical error occured! Please try again later.",{title:"Error !",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1}}))}function onLocalityChange(e,t){if($("#address_sub_locality").length&&$(".subLocalityList").remove(),$("#address_area1").length&&$(".area1List").remove(),$(".dropListMap").addClass("hide"),$(".zipprDrop").addClass("hide"),$(".dropListBottom").html(""),$(".dropListMiddle").html(""),$(".address_house").remove(),$(".address_street").remove(),$(".homeOrOffice").remove(),""!=e){var r=$("#address_city option:selected").val(),a=$.trim($("#address_locality option:selected").val()).split("#")[0].split("^"),s={},i="";$.each(a,function(e,t){0==e&&""!=t?s.locality=t:1==e&&""!=t?(i=t,s.subLocality=t):2==e&&""!=t?s.area1=t:3==e&&""!=t&&(s.area2=t)});var o="";if($("#address_locality option").each(function(){$.trim($(this).text())==s.locality?o+='<option selected="selected" value="'+$.trim($(this).val())+'">'+$.trim($(this).text())+"</option>":o+='<option value="'+$.trim($(this).val())+'">'+$.trim($(this).text())+"</option>"}),$("#address_locality").html(o),""!==r&&void 0!==s.locality){$("#"+t).val(s.locality);var l={locality:s.locality};$.when(getSubLocality(r,l,i)).then(function(e){if(e.status)if(""!=e.data){o='<option value="">Select Sub Locality</option>';for(var t in e.data)$.trim(e.data[t])==i?o+='<option selected="selected" value="'+t+'">'+$.trim(e.data[t])+"</option>":o+='<option value="'+t+'">'+$.trim(e.data[t])+"</option>";if($("#address_sub_locality").length)$("#address_sub_locality").html(o);else{var a='                <ul class="drRow">\n                  <li class="subLocality">\n                    <div class="dropListrow">\n                      <label>Select a Sub Locality</label>\n                      <div class="dropList">\n                        <select name="select" id="address_sub_locality" class="selectpicker">\n                        '+o+"\n                        </select>\n                      </div>\n                    </div>\n                  </li>\n                </ul>";$(".dropListMiddle").html(a),$("#address_sub_locality").combobox()}}else{var o='<ul class="drRow"></ul>';$(".dropListMiddle").html(o),appendBottomHtml()}if(void 0!==s.subLocality){var l={locality:s.locality,subLocality:s.subLocality};getArea1(r,l,s)}})}}}function onSubLocalityChange(e,t){if($("#address_area1").length&&$(".area1List").remove(),$(".area2List").remove(),$(".dropListBottom").html(""),$(".address_house").remove(),$(".address_street").remove(),$(".homeOrOffice").remove(),$(".dropListMap").addClass("hide"),$(".zipprDrop").addClass("hide"),""!=e){var r=$("#address_city option:selected").val(),a=$.trim($("#address_sub_locality option:selected").val()).split("#")[0].split("^"),s={};s.locality=$.trim($("#address_locality option:selected").html()),$.each(a,function(e,t){0==e&&""!=t?s.subLocality=t:1==e&&""!=t?s.area1=t:2==e&&""!=t&&(s.area2=t)});var i="";$("#address_sub_locality option").each(function(){$.trim($(this).text())==s.subLocality?i+='<option selected="selected" value="'+$.trim($(this).val())+'">'+$.trim($(this).text())+"</option>":i+='<option value="'+$.trim($(this).val())+'">'+$.trim($(this).text())+"</option>"}),$("#address_sub_locality").html(i),$("#address_sub_locality").combobox(),void 0!==s.subLocality?($("#"+t).val(s.subLocality),getArea1(r,{locality:s.locality,subLocality:s.subLocality},s)):appendBottomHtml()}}function onArea1Change(e,t){if($(".area2List").remove(),$(".dropListBottom").html(""),$(".address_house").remove(),$(".address_street").remove(),$(".homeOrOffice").remove(),$(".dropListMap").addClass("hide"),$(".zipprDrop").addClass("hide"),e){var r=$("#address_city option:selected").val(),a=$.trim($("#address_locality option:selected").html()),s=$.trim($("#address_area1 option:selected").val()).split("#")[0].split("^"),i=$.trim($("#address_sub_locality option:selected").html()),o={};o.locality=a,$.each(s,function(e,t){0==e&&""!=t?o.area1=t:1==e&&""!=t&&(o.area2=t)});var l="";$("#address_area1 option").each(function(){$.trim($(this).text())==$.trim(o.area1)?l+='<option selected="selected" value="'+$.trim($(this).val())+'">'+$.trim($(this).text())+"</option>":l+='<option value="'+$.trim($(this).val())+'">'+$.trim($(this).text())+"</option>"}),$("#address_area1").html(l),$("#address_area1").combobox(),void 0!==o.area1&&""!=o.area1?($("#"+t).val(o.area1),getArea2(r,{locality:o.locality,subLocality:i,area1:o.area1},o.area2)):appendBottomHtml()}}function onArea2Change(e){$(".dropListBottom").html(""),$(".address_house").remove(),$(".address_street").remove(),$(".homeOrOffice").remove(),$(".dropListMap").addClass("hide"),$(".zipprDrop").addClass("hide"),e&&appendBottomHtml()}function showPopupAfterZipperFetched(e){var t='\n      <li class="address_street">\n        <div class="dropListrow">\n          <label>Selected City</label>\n          <div class="dropList">\n            <input type="text" id="zipperCity" disabled="disabled" name="text" value="'+e.zipperCity+'" placeholder="Type Street/Society name" maxlength="50">\n          </div>\n        </div>\n      </li>\n      <li class="address_street">\n        <div class="dropListrow">\n          <label>Selected Locality</label>\n          <div class="dropList">\n            <input type="text" id="zipperLocality" disabled="disabled" name="text" value="'+e.zipperLocality+'" placeholder="Type Street/Society name" maxlength="50">\n          </div>\n        </div>\n      </li>';void 0!==e.zipperSubLocality&&""!=e.zipperSubLocality&&(t+='\n        <li class="address_street">\n          <div class="dropListrow">\n            <label>Selected SubLocality</label>\n            <div class="dropList">\n              <input type="text" id="zipperSubLocality" name="text" value="'+e.zipperSubLocality+'" placeholder="Type Street/Society name" maxlength="50">\n            </div>\n          </div>\n        </li>'),$(".dropListTop").html(t);$("#zipperStreet").length<=0&&$(".dropListMiddle").append('\n      <li class="address_street">\n        <div class="dropListrow">\n          <label>Street/Society name</label>\n          <div class="dropList">\n            <input type="text" id="zipperStreet" value="" placeholder="Type Street/Society name" maxlength="50">\n          </div>\n        </div>\n      </li>\n      <li class="address_house">\n        <div class="dropListrow">\n          <label>Flat/House Number</label>\n          <div class="dropList">\n            <input type="text" id="zipperFlat" value="" placeholder="Type Flat/House Number" maxlength="10">\n          </div>\n        </div>\n      </li>');return $(".homeOrOffice").length<=0&&($(".dropListMiddle").append('\n      <li class="homeOrOffice">\n        <div class="dropListrow">\n          <label>My</label>\n          <div class="dropList">\n            <select id="homeOrOffice">\n                <option value="Home">Home</option>\n                <option value="Office">Office</option>\n             </select>\n          </div>\n        </div>\n      </li>'),$(".dropListBottom").html('<input type="hidden" value="zipperAddress" id="zipperAddress"/><input type="submit" name="submit" id="zipperSubmit" value="SUBMIT">')),$("#fade").popup("show"),!0}function setStore(e,t){showPageBlocker();var r="";r=void 0!==t?$.trim($(t).children("h5").children(".addressName").val()):$.trim($("#default_address_1").siblings("h5").children(".addressName").val());var a=0;void 0!==e.isZippr&&1==e.isZippr&&(a=1);var s=$("#reviewPageLocator").val();void 0===s&&(s=""),$.ajax({url:baseurl+"/setStore",dataType:"json",type:"POST",data:{store_code:e.storeCode,first_time_customer:"No",selCity:e.selCity,selLocality:e.selLocality,selSubLocality:e.selSubLocality,selArea1:e.selArea1,selArea2:e.selArea2,house:e.houseNo,street:e.street,request_page:"welcome",isAjax:!0,"home-or-pickup":"home-delivery",addressType:e.addressType,defaultStore:e.defaultStore,csrf_token:csrfToken,addressName:r,isZippr:a,lat:e.lat,lon:e.lon,is_review_page:s},success:function(r){if(1==r.directLogin&&(window.location=r.menuPageUrl),$(".myFavOrderContent").length>0){if($(".myFavOrderContent").html(r.favouriteOrderHtml),r.buildOrderHtml){$(".myFavOrderContent").append("<p>You haven't placed any orders yet.</p><p>BUILD AND SAVE YOUR FAVOURITE MEAL!</p>")}$(".myFavOrderContent").append('<a href="'+r.menuPageUrl+'" class="btnRed">BUILD A NEW ORDER</a></p>'),"undefined"!=typeof isCartEmpty&&"no"==isCartEmpty&&($(".menu a").attr("href",r.menuPageUrl),$(".menu a").css("cursor","pointer"))}if($(".offerstrip").length>0&&void 0!==r.offerHtml&&($(".offerstrip").remove(),$(".headerContainer").prepend(r.offerHtml)),hidePageBlocker(),void 0!==t){var a=$(t).siblings(".default").attr("id");$("#"+a).removeClass("default"),$(t).addClass("default")}if(r.status){var s=location.pathname.split("/");s=s[1],void 0!==e.action&&"default"==e.action?(showPageBlocker(),window.location=r.menuPageUrl):"menu"!=s&&"review"!=s||(showPageBlocker(),window.location=r.menuPageUrl)}else{if(void 0!==r.data&&""!=r.data&&void 0!==r.data.flag&&0==r.data.flag){if($("#googleBuildOrder").length){$.prompt("Your Restaurant address has been modified, Please update your selected address.",{title:"Update your selected address!",buttons:{Ok:!0,Cancel:!1},submit:function(t,r,a,s){if(1==r){var i=e.selCity+" "+e.selLocality+" "+e.selSubLocality;return showMapByAddress(i),!0}}})}return!1}$.prompt("We regret that requested Domino's Pizza Restaurant is not available currently for Online Ordering. You may please choose to call us up at 1860-210-0000 to place your order.",{title:"Alert!",buttons:{Ok:!0},submit:function(t,a,s,i){if(1==a){var o=location.pathname.split("/");o=o[1],void 0!==e.action&&"default"==e.action?(showPageBlocker(),window.location=r.menuPageUrl):"menu"!=o&&"review"!=o||(showPageBlocker(),window.location=r.menuPageUrl)}}})}hidePageBlocker()},error:function(){return hidePageBlocker(),$.OLOMessages.set("Some technical error occured!Please try later.","Error!"),$.OLOMessages.displayAlert(),!1}})}var cityId="",orderType="",selectedAddress="",completeLocality=!1,homePickupRadioBtn="home-delivery";$(document).ready(function(){if("undefined"!=typeof IsAddressSave&&1==IsAddressSave){var e=$.trim($("#default_address_1").siblings(".addressText").children("p").children(".city").val()),t=$.trim($("#default_address_1").siblings(".addressText").children("p").children(".locality").val()),r=$.trim($("#default_address_1").siblings(".addressText").children(".store-id").val()),a=$.trim($("#default_address_1").siblings(".addressText").children("p").children(".sub_locality").val()),s=$.trim($("#default_address_1").siblings(".addressText").children("p").children(".house").val()),i=$.trim($("#default_address_1").siblings(".addressText").children("p").children(".street").val()),o=$.trim($("#default_address_1").siblings(".addressText").children(".zipper-code").val()),l=$.trim($("#default_address_1").siblings(".addressText").children("p").children(".area1").val()),d=$.trim($("#default_address_1").siblings(".addressText").children("p").children(".area2").val()),n=$.trim($("#default_address_1").siblings(".addressText").children(".lat").val()),c=$.trim($("#default_address_1").siblings(".addressText").children(".lon").val());""!=o&&"undefined"!=o?getAddressByZippr(o,{addressType:r},"updateZipper"):void 0!==n&&""!=n&&""!=typeof c&&""!=c?setStore({selCity:e,selLocality:t,selSubLocality:a,selArea1:l,selArea2:d,houseNo:i,street:s,addressType:r,defaultStore:!1,storeCode:store_code,lat:n,lon:c}):checkStoreDetail(e,t,a,l,d,i,s,r,"#addressBox_1")}"undefined"!=typeof cityName&&""!=cityName&&setTimeout(function(){$("#combobox").combobox("autocomplete",cityName),$("#combobox option").filter(function(){return this.text==cityName}).attr("selected",!0),getLocality(cityName)},10),$(document).on("click","#zippr_submit",function(e){var t=$.trim($("#zippr_code").val());if(""==t)return $.OLOMessages.set("Zippr code should not be empty.","Alert!"),$.OLOMessages.displayAlert(),!1;zipperSource="primary",getAddressByZippr(t)}),$(document).on("click",".orderType",function(){if($(this).find(".orderTypeRadioBtn").is(":checked")){$("#combobox").html("");var e=this.id;"homeDeliveryChkBox"==e?($("#combobox").html($("#home_delivery").html()),"undefined"!=typeof currentTime&&"undefined"!=typeof startTime&&"undefined"!=typeof endTime&&currentTime>=startTime&&currentTime<endTime?$(".zipperCode").show():$(".zipperCode").hide(),$("#googleBuildOrder").length&&($(".submitrow").children("#buildOrderBtn").attr("id","geoBuildOrder"),$("#buildOrderBtn").prop("disabled",!0),$("#buildOrderBtn").addClass("hide"))):"pickUpChkBox"==e&&($("#combobox").html($("#pick_up").html()),$(".zipperCode").hide(),$("#geoBuildOrder").length&&($(".submitrow").children("#geoBuildOrder").attr("id","buildOrderBtn"),$("#buildOrderBtn").prop("disabled",!1),$("#buildOrderBtn").removeClass("hide"))),$("#combobox option").filter(function(){return this.text==cityName}).attr("selected",!0)}}),$(document).on("click","#buildOrderBtn",function(){if(""!=cityName&&$("#combobox").val(cityName),!$(".orderTypeRadioBtn").is(":checked"))return $.OLOMessages.set("Please select order medium. Pick Up or Home Delivery.","Alert!"),$.OLOMessages.displayAlert(),!1;e="home_delivery";if($("#pick-up").is(":checked"))var e="pick_up";if(""==$.trim($("#combobox").val()))return hidePageBlocker(),$.prompt("Please select your city.",{title:"Alert!",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1;if(""==$.trim($(document).find("#combobox_locality").find(":selected").val())&&"pick_up"==e)return $.OLOMessages.set("Please select your Restaurants.","Alert!"),$.OLOMessages.displayAlert(),!1;if(""==$.trim($(document).find("#combobox_locality").find(":selected").val())&&"home_delivery"==e&&(hidePageBlocker(),"undefined"!=typeof currentTime&&"undefined"!=typeof startTime&&"undefined"!=typeof endTime)){if(currentTime>=startTime&&currentTime<=endTime){return $.prompt("Please enter your complete location.",{title:"Alert!",buttons:{Ok:!0},submit:function(e,t,r,a){if(1==t)return!0}}),!1}return $.prompt("Please select your Locality.",{title:"Alert!",buttons:{Ok:!0},timeout:popUpTimeOut,submit:function(e,t,r,a){if(!0)return!0}}),!1}}),$(document).on("click",".remove_locality_tag",function(){completeLocality=!1;e="home_delivery";if(orderType="homedelivery",$("#pick-up").is(":checked")){completeLocality=!0;var e="pick_up";orderType="pickup",$("#custAddress").val("Select Restaurants")}else $("#custAddress").val("Enter Locality/Area");cityId=$("#combobox").find(":selected").val(),setTimeout(function(){if("home_delivery"==e){var t={locality:"",subLocality:"",area1:""};if($(document).find(".addressTag").each(function(e){switch(e){case 0:t.locality=$(this).find(".locality_html").html(),selectedAddressValue=t.locality+"^",selectedAddressText=t.locality+" ";break;case 1:t.subLocality=$(this).find(".locality_html").html(),selectedAddressValue+=t.subLocality+"^",selectedAddressText+=t.subLocality+" ";break;case 2:t.area1=$(this).find(".locality_html").html(),selectedAddressValue+=t.area1+"^",selectedAddressText+=t.area1+" "}}),""!=cityId&&""!=orderType&&""==t.locality)return void getLocalityForCity(cityId,orderType);""!=cityId&&""!=t.locality&&getStoreAddress(cityId,t)}else"pickup"==orderType&&(completeLocality=!0,getLocalityForCity(cityId,orderType))},200);var t=$(this).parent().outerWidth(),r=parseInt($("#custAddress").css("padding-left"));$(this).parent().nextAll().remove(),$(this).parent().remove();var a=r-t;a<28&&(a=28),addressTagCount(),adjustHeight(),$("#custAddress").css({paddingLeft:getTagsWidth()}).focus().blur(),$("#custAddress").val("Enter Locality/Area")}),$("input:radio[name=home-or-pickup]").on("change",function(e){e.preventDefault();var t=location.pathname.split("/");t=t[1],homePickupRadioBtn=$(this).val(),$(".submitrow").removeClass("active1"),$(".addressTag").length,""!=t&&"menu"==t||($("#pick-up").is(":checked")?($(".deliveryAddress,.tagareaWrap").addClass("pickupSelect"),$("#custAddress").addClass("pickupSelect").val("Select Restaurants"),$(".tagArea").html(""),$(".tagareaWrap").css({height:""}),$(".submitrow").removeClass("active"),$("#custAddress").css({paddingLeft:"35px"})):($("#custAddress").removeClass("pickupSelect").val("Enter Locality/Area"),$(".deliveryAddress,.tagareaWrap").removeClass("pickupSelect"),$(".tagArea").html(""),$(".tagareaWrap").css({height:""}),$(".submitrow").removeClass("active"),$("#custAddress").css({paddingLeft:"28px"})),$("#combobox_locality").html(""),$(".tagArea").html(""),$("#googleBuildOrder").length&&$("#pick-up").is(":checked")&&getLocality(cityName))}),$(document).on("click","#submitAddress",function(e){e.preventDefault();var t="new",r=$("#address_city option:selected").val(),a=$.trim($("#address_locality option:selected").html()),s=$.trim($("#address_locality option:selected").html()),i=$.trim($("#address_sub_locality option:selected").html()),o=$.trim($("#address_street").val()),l=$.trim($("#address_house").val()),d=$.trim($("#address_area1 option:selected").html()),n=$.trim($("#address_area2 option:selected").html()),c=$.trim($("#addressType").val()),p=$.trim($("#homeOrOffice option:selected").html()),u="";if(void 0!==a&&""!=a&&"Select Locality"!=a||(u+="Please Enter locality ! <br/>"),void 0!==o&&""!=o||(u+="Please Enter Street! <br/>"),void 0!==l&&""!=l||(u+="Please Enter house/Flat number! <br/>"),void 0!==p&&""!=p||(u+="Please Choose your address type Home or Office!<br/>"),""!=u)return $.OLOMessages.set(u,"Alert!"),$.OLOMessages.displayAlert(),!1;var m=$.trim($("#address_locality option:selected").val()).split("#");if(m=m[1],$("#updateAddress").length>0)h={city:r,locality:s,subLocality:i,storeCode:m,customLocator:!0,street:o,house:l,selArea1:d,selArea2:n,type:t="update",addressType:c,myAddressType:p,csrf_token:csrfToken};else var y=$.trim($(".savedAddresses").val()),h={city:r,locality:s,subLocality:i,storeCode:m,customLocator:!0,street:o,house:l,selArea1:d,selArea2:n,type:t,myAddressType:p,csrf_token:csrfToken,totalCount:y};"new"==t?saveOrUpdateAddress(h,"saveNewAddress"):"update"==t&&saveOrUpdateAddress(h,"updateAddress")}),$(document).on("click","#zipperSubmit",function(e){e.preventDefault();var t=$.trim($("#zipperStreet").val()),r=$.trim($("#zipperFlat").val()),a=$.trim($("#homeOrOffice option:selected").html()),s=$.trim($("#zipperSubLocality").val()),i="";if(void 0!==t&&""!=t||(i+="Please Enter Street! <br/>"),void 0!==r&&""!=r||(i+="Please Enter house/Flat number! <br/>"),void 0!==a&&""!=a||(i+="Please Choose your address type Home or Office!<br/>"),""!=i)return $.OLOMessages.set(i,"Alert!"),$.OLOMessages.displayAlert(),!1;saveOrUpdateAddress({customLocator:!0,street:t,house:r,subLocality:s,isZipperSubmit:!0,myAddressType:a,csrf_token:csrfToken},"saveNewAddress")}),$(document).on("focusout",".selectCity",function(e){e.preventDefault(),"undefined"!=typeof cityName&&""!=cityName&&$("#custCity").val(cityName)})});var getUrlParameter=function(e){var t,r,a=decodeURIComponent(window.location.search.substring(1)).split("&");for(r=0;r<a.length;r++)if((t=a[r].split("="))[0]===e)return void 0===t[1]||t[1]};