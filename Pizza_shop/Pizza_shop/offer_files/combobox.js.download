var selectedVar="",cityName="";!function(a){a.widget("custom.combobox",{_create:function(){this.wrapper=a("<span>").addClass("custom-combobox").insertAfter(this.element),this.element.hide(),this._createAutocomplete(),this._createShowAllButton()},_createAutocomplete:function(){var b=this.element.children(":selected"),c=b.val()?b.text():"",d=this.element.parent();this.input=a("<input>").appendTo(this.wrapper).val(c).attr("title","").addClass("custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left").autocomplete({appendTo:d,delay:0,minLength:3,source:a.proxy(this,"_source"),close:function(a,b){},select:function(b,c){return a(this).val(c.item.label).blur(),!1}}).tooltip({tooltipClass:"ui-state-highlight"}),this.input.parents(".selectCity").length>0&&(this.input.val("Select City"),this.input.attr("id","custCity")),this.input.parents(".selectLocation").length>0&&(this.input.attr("id","custAddress"),this.input.val("Enter Locality/Area")),this._on(this.input,{autocompleteselect:function(b,c){c.item.option.selected=!0,this._trigger("select",b,{item:c.item.option});var d=this.element.children(":selected").val(),e=d.split("#"),f=e[0].split("^"),g=this.input;setTimeout(function(){if(g.parents(".selectLocation").length>0){if(a("#pick-up").is(":checked")){var b=g.val();g.val("").blur();var c=b.split(",")}else c=f;for(v in c)a("#custAddress").val(a.trim(c[v])),addressToTags()}},100);var h=a(".tagArea").html();if("combobox"==this.element.attr("id")&&(cityName=this.element.children(":selected").val(),setTimeout(function(){getLocality(cityName)},200),""!=h&&(a(".addressTag .close:first").click(),a("#combobox_locality").html(""),a(".tagArea").html(""))),"combobox_locality"==this.element.attr("id")){var i="homedelivery";if(a("#pick-up").is(":checked")&&(i="pickup"),"pickup"==i){var j=this.element.children(":selected").val();a("#store_code").val(j);var k=a.trim(this.element.children(":selected").html());a("#store_name").val(k),setTimeout(function(){a(".submitrow").addClass("active1"),a("#buildOrderBtn").focus(),a("#buildOrderBtn").prop("disabled",!1)},100),""!=h&&a(".tagArea").html("")}setTimeout(function(){"pickup"!=i&&(""!=cityName?getLocality(cityName):"undefined"!=typeof selectedCity&&""!=selectedCity&&getLocality(selectedCity))},100)}},autocompletechange:"_removeIfInvalid"})},_createShowAllButton:function(){var b=this.input,c=!1;a("<a>").attr("tabIndex",-1).attr("title","Show All Items").tooltip().appendTo(this.wrapper).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("custom-combobox-toggle ui-corner-right locality_arrow").mousedown(function(){c=b.autocomplete("widget").is(":visible")}).click(function(){b.val(""),c||b.autocomplete("search","")})},_source:function(b,c){var d=new RegExp(a.ui.autocomplete.escapeRegex(b.term),"i");c(this.element.children("option").map(function(){var c=a(this).text();if(this.value&&(!b.term||d.test(c)))return{label:c,value:c,option:this}}))},_removeIfInvalid:function(b,c){if(!c.item){var d=this.input.val(),e=d.toLowerCase(),f=!1;this.element.children("option").each(function(){if(a(this).text().toLowerCase()===e)return this.selected=f=!0,!1}),f||(this.input.val("").attr("title",d+" didn't match any item").tooltip("open"),this.element.val(""),this._delay(function(){this.input.tooltip("close").attr("title","")},2500),this.input.autocomplete("instance").term="")}},_destroy:function(){this.wrapper.remove(),this.element.show()},autocomplete:function(a){this.element.val(a),this.input.val(a)}})}(jQuery),$(function(){$("#combobox").combobox(),$("#combobox_locality").combobox(),$(".selectCity").on("focusin",".custom-combobox-input",function(){"Select City"==$(this).val()&&$(this).val("")}),$(document).on("focusout","#custCity",function(){""==cityName&&""==$(this).val()&&setTimeout(function(){$("#custCity").val("Select City")},10)}),$(".ui-button").click(function(){var a=$(this).parent(".custom-combobox").children(".custom-combobox-input").attr("id");selectedVar=a}),$(document).click(function(a){$(a.target).hasClass("custom-combobox-toggle")||$(a.target).hasClass("ui-button-icon-primary")||($("#"+selectedVar).autocomplete("close"),""===$.trim(""==$(".tagArea").html()&&$("#custAddress").val())&&"custAddress"!=$(a.target).attr("id")&&($(".pickupSelect").length>0?$("#custAddress").val("Select Restaurants"):$("#custAddress").val("Enter Locality/Area")),""===$.trim($("#custCity").val())&&"custCity"!=$(a.target).attr("id")&&$("#custCity").val("Select City"))})}),$(document).ready(function(){$("#custAddress").attr("autocorrect","off"),$("#custAddress").attr("spellcheck","false")});