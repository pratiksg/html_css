function initAutoSuggest(){var e=new google.maps.places.Autocomplete(document.getElementById("custGeoAddress"));e.setComponentRestrictions({country:"in"}),hidePageBlocker(),google.maps.event.addListener(e,"place_changed",function(){var o=e.getPlace();if(!o.geometry)return hidePageBlocker(),!1;if(1==presentlocality(o)){var t=JSON.stringify(o),a=$("#geoGeometry").val(t);"undefined"!=a&&""!=a&&$("#storeLocatorGeoForm").submit()}else{hidePickupButton=1;var n='<div class="pac-card" id="pac-card">\n      <div id="pac-container">\n      <span class="pac-search-icn"></span>\n      <input id="pac-input" type="text" onClick = "singleClickSelect()" placeholder="Enter a location" class = "geoInputBox">\n      <div class="map-locate-me-box" id="geoLocate">\n      <div class="locate-btn" id ="locateMe">\n      <span class="map-icon">&nbsp;</span>\n      <input type="button" value="Detect" id="get-location">\n      </div>\n      </div></div>\n      <div id="infowindow-content">\n      <img src="" width="16" height="16" id="place-icon">\n      <span id="place-address" style="display: inline-block; padding-left: 15px;"></span>\n      </div>';$(n).insertBefore($("#map")),initMap(o),$("#map_slide").popup("show"),$("#map_slide_wrapper").css({opacity:1})}})}function initMap(e){var o=new google.maps.Map(document.getElementById("map"),{zoom:13,fullscreenControl:!1}),t=document.getElementById("pac-card"),a=document.getElementById("pac-input");o.controls[google.maps.ControlPosition.TOP_RIGHT].push(t);var n=new google.maps.InfoWindow,s=document.getElementById("infowindow-content");n.setContent(s);var i=new google.maps.Marker({map:o,anchorPoint:new google.maps.Point(0,-29),draggable:!0,icon:imageThemeUrl+"/images/google-icon.png"});window.setTimeout(function(){google.maps.event.trigger(o,"resize"),o.panTo(i.getPosition()),o.setZoom(13)},10),google.maps.event.addListener(i,"dragend",function(){ock=0,o.panTo(i.getPosition()),setTimeout(function(){i.setMap(o)},10)}),google.maps.event.addListener(o,"dragend",function(){i.setPosition(this.getCenter())}),google.maps.event.addListener(o,"zoom_changed",function(){i.setPosition(this.getCenter())}),$("#pac-card ul").css("display","none"),$(".maps-tooltip").css("display","block"),loadDetails(e,o,i,n,s);var r=new google.maps.places.Autocomplete(a);r.bindTo("bounds",o),r.setComponentRestrictions({country:"in"}),google.maps.event.addListener(r,"place_changed",function(){var e=r.getPlace();if(1==presentlocality(e)){var t=JSON.stringify(e),a=$("#geoGeometry").val(t);"undefined"!=a&&""!=a&&$("#storeLocatorGeoForm").submit()}else hidePickupButton=1;$(".maps-tooltip").css("display","block"),loadDetails(e,o,i,n,s)}),$(".addnewadressPopup").popup("hide")}function loadDetails(e,o,t,a,n){$("#place-icon").removeClass("hide"),$("#place-name").next("br").remove(),$("#place-name").remove();var s='<span id="place-name"  class="title">'+e.name+"</span><br>";"undefined"!=typeof e.name&&""!=e.name&&$(s).insertBefore("#place-address"),$(".maps-tooltip").delay(6e3).fadeOut(5e3),$("#place-icon").removeClass("hide"),"undefined"!=typeof e.name&&""!=e.name&&$("#place-name").text(e.name);var i=JSON.stringify(e);if($("#geoGeometry").val(i),google.maps.event.addListener(t,"dragend",function(){var e=t.getPosition();geocodePlaceId(e,2)}),google.maps.event.addListener(o,"dragend",function(){var e=t.getPosition();geocodePlaceId(e,2)}),a.close(),t.setVisible(!1),!e.geometry)return!1;e.geometry.viewport?o.fitBounds(e.geometry.viewport):(o.setCenter(e.geometry.location),o.setZoom(17)),t.setPosition(e.geometry.location),t.setVisible(!0);var r="";if(e.address_components&&(r=[e.address_components[0]&&e.address_components[0].short_name||"",e.address_components[1]&&e.address_components[1].short_name||"",e.address_components[2]&&e.address_components[2].short_name||""].join(" ")),$("#place-name").siblings("br").remove(),$("#place-name").remove(),"undefined"!=typeof e.name&&""!=e.name){var s='<span id="place-name"  class="title">'+e.name+"</span><br>";$(s).insertBefore("#place-address")}"undefined"!=typeof e.icon&&""!=e.icon&&($("#place-icon").removeClass("hide"),n.children["place-icon"].src=e.icon),$("#place-icon").removeClass("hide"),n.children["place-address"].textContent=r,a.open(o,t),checklocality(e,2)}function geoMapHtml(){var e="";return"undefined"!=typeof GeoCookieValue&&""!=GeoCookieValue?($.each(GeoCookieValue,function(o,t){var a=t.split("#");e+='<br><div id = "pac-card" class = "pac-card"><ul style="list-style:none; text-align:left;color: #000; padding:0; margin:0;font-family:sfUIdisplay-regular;"> <li style="padding:5px 10px; font-size: 15px;"><span class="map-icon-dropdown"></span><span id = "geo_recent-'+o+'" class = "geoRecentAddress">'+a[0]+"</span></li></ul></div>"}),e):void 0}function geocodePlaceId(e,o){hidePageBlocker();var t="",a="";if("undefined"!=typeof o&&1==o)a={placeId:e};else if(2==o)a={location:e};else{if("undefined"==typeof e.coords.latitude||"undefined"==typeof e.coords.longitude||""==e.coords.latitude||""==e.coords.longitude)return!1;var n=e.coords.latitude,s=e.coords.longitude,i={lat:parseFloat(n),lng:parseFloat(s)};a={location:i}}if("undefined"!=typeof google){var r=new google.maps.Geocoder;r.geocode(a,function(e,a){if(hidePageBlocker(),"OK"===a){if(2==o){var n=JSON.stringify(e[0]);return $("#geoGeometry").val(n),checklocality(e[0],1),$.each(e[0].address_components,function(e,o){-1==$.inArray("premise",o.types)&&-1==$.inArray("postal_code",o.types)&&-1==$.inArray("street_number",o.types)&&(t+=o.long_name+", "),0==$.inArray("postal_code",o.types)&&(t+=o.long_name)}),$("#place-icon").addClass("hide"),$("#place-name").siblings("br").remove(),$("#place-name").remove(),!0}if(3==o){if("undefined"!=typeof e[0]){var n=JSON.stringify(e[0]);$("#geoGeometry").val(n),showPageBlocker();var s=$("#geoGeometry").val();"undefined"!=s&&""!=s&&$("#storeLocatorGeoForm").submit()}}else if(1==presentlocality(e[0])){var i=JSON.stringify(e[0]),s=$("#geoGeometry").val(i);"undefined"!=s&&""!=s&&("undefined"!=typeof autoDetect&&1==autoDetect&&$("#location-source").val(1),$("#storeLocatorGeoForm").submit())}else{var r='<div class="pac-card" id="pac-card">\n          <div id="pac-container">\n          <span class="pac-search-icn"></span>\n          <input id="pac-input" type="text" onClick = "singleClickSelect()" placeholder="Enter a location" class = "geoInputBox" value="'+e[0].formatted_address+'"/>\n          <div class="map-locate-me-box" id="geoLocate">\n          <div class="locate-btn" id ="locateMe">\n          <span class="map-icon">&nbsp;</span>\n          <input type="button" value="Detect" id="get-location">\n          </div>\n          </div></div>\n          <div id="infowindow-content">\n          <img src="" width="16" height="16" id="place-icon">\n          <span id="place-address" style="display: inline-block; padding-left: 15px;"></span>\n          </div>';$(r).insertBefore($("#map")),initMap(e[0],1),$("#map_slide").popup("show"),$("#place-icon").addClass("hide")}}})}else{var d="00";fetchAndShowMessage(d)}}function appendSaveAddress(){var e="";return"undefined"!=typeof saveAddress&&""!=saveAddress?($.each(saveAddress,function(o,t){var a="";"undefined"!=typeof t.building_number&&"undefined"!=typeof t.street_name&&""!=t.building_number&&""!=t.street_name&&(a=t.building_number+", "+t.street_name+", "),e+="undefined"!=typeof t.latitude&&"undefined"!=typeof t.longitude&&""!=t.latitude&&""!=t.longitude?'<br><div id = "pac-card" class = "pac-card" style="font-family:sfUIdisplay-medium;font-size: 12px;"><span class="map-icon-dropdown"></span><span id = "geo_save-'+o+'" class = "geoSaveAddress isGeoAddress">'+a+t.city_region+","+t.city+"</span></div>":'<br><div id = "pac-card" class = "pac-card" style="font-family:sfUIdisplay-medium; font-size: 12px;"><span class="map-icon-dropdown"></span><span id = "geo_save-'+o+'" class = "geoSaveAddress">'+a+t.city_region+","+t.city+"</span></div>"}),e):void 0}function changeDelievryMode(e){"pick-up"==e?($(".deliveryAddress").append('<div class="tagArea"></div>'),$("#geoBuildOrder").prop("disabled",!1),$(".input-location").addClass("hide"),$("#geoBuildOrder").removeClass("hide"),$("#geoLocate").addClass("hide"),$(".map-locate-me-box").remove(),$("#geo-widget").removeClass("hide"),$("#custGeoAddress").addClass("hide"),$("#geoPickup").removeClass("hide"),$(".deliveryAddress,.tagareaWrap").addClass("pickupSelect"),$("#custGeoAddress").addClass("pickupSelect").val("Select Restaurants"),$(".tagArea").html(""),$(".tagareaWrap").css({height:""}),$(".submitrow").removeClass("active"),$(".homeContainer .orderform").removeClass("hm-delivery")):($(".tagArea").remove(),$("#geoBuildOrder").prop("disabled",!0),$(".input-location").removeClass("hide"),$("#geoBuildOrder").addClass("hide"),$("#geoLocate").removeClass("hide"),$(".map-locate-me-box").remove(),$("#geo-widget").addClass("hide"),$("#custGeoAddress").removeClass("hide"),$("#geoPickup").addClass("hide"),$("#custGeoAddress").removeClass("pickupSelect").val(""),$(".deliveryAddress,.tagareaWrap").removeClass("pickupSelect"),$(".tagArea").html(""),$(".tagareaWrap").css({height:""}),$(".submitrow").removeClass("active"),$(".homeContainer .orderform").addClass("hm-delivery"))}function getLocation(){if(!navigator.geolocation){var e="00";return fetchAndShowMessage(e),!1}navigator.geolocation.getCurrentPosition(showPosition,googleMapError)}function showPosition(e){""!=e.coords.latitude&&""!=e.coords.longitude&&(showPageBlocker(),geocodePlaceId(e))}function closeMap(){$("#map_slide").popup("hide"),$("#custGeoAddress").val(""),$(".map-locate-me-box").remove(),$("#custGeoAddress").attr("placeholder","Enter Area/Locality")}function checklocality(e,o){console.log(e);var t="n",a="",n=new Array;if("undefined"!=typeof e&&""!=e){if($.each(e.address_components,function(e,o){-1==$.inArray("postal_code",o.types)&&-1==$.inArray("country",o.types)&&-1==$.inArray("administrative_area_level_1",o.types)&&-1==$.inArray("administrative_area_level_2",o.types)&&-1==$.inArray("administrative_area_level_3",o.types)&&-1==$.inArray("administrative_area_level_4",o.types)&&-1==$.inArray("administrative_area_level_5",o.types)&&(-1!=$.inArray("sublocality_level_1",o.types)||-1!=$.inArray("sublocality_level_2",o.types)||-1!=$.inArray("sublocality_level_3",o.types)||-1!=$.inArray("sublocality_level_4",o.types))&&(n[e]=o.long_name)}),n.length>=2)return t="y",$("#geoContinue").hasClass("geo-continue-btn")||(0==hidePickupButton?$("#templateAppend").append('<div id ="geoContinue" class="geo-continue-btn"> <input type = "hidden"  value= "'+o+'" name="location_source"/> <input type = "button" class = "submitButton" value="Pick this Location" id = "submitLocation"></div>'):(hidePickupButton=0,$("#geoContinue").hide())),$.each(e.address_components,function(e,o){(-1!=$.inArray("sublocality_level_1",o.types)||-1!=$.inArray("sublocality_level_2",o.types)||-1!=$.inArray("locality",o.types))&&(a+=o.long_name+",")}),a=a.slice(0,-1),$("#place-address").text(a),void $(".geoInputBox").val(a);"n"==t&&($.each(e.address_components,function(e,o){(-1!=$.inArray("locality",o.types)||-1!=$.inArray("administrative_area_level_2",o.types))&&(a=o.long_name)}),$("#geoContinue").remove(),$(".geoInputBox").val(""),$("#place-address").text(a),$(".geoInputBox").attr("placeholder","Where in "+a+"?"))}return t}function googleMapError(e){var o="00";switch(e.code){case e.PERMISSION_DENIED:o="02";break;case e.POSITION_UNAVAILABLE:o="03";break;default:o="00"}fetchAndShowMessage(o)}function showMapByAddress(e){showPageBlocker(),$.ajax({type:"get",url:baseurl+"/GetSuggestedAddress",dataType:"json",data:{input:e},success:function(e){hidePageBlocker(),"undefined"!=typeof e.data.results[0]&&"undefined"!=typeof e.data.results[0].place_id&&geocodePlaceId(e.data.results[0].place_id,1)},error:function(e){hidePageBlocker()}})}function fetchAndShowMessage(e){if("undefined"!=typeof e&&""!==e){var o={Cancel:!1,"Store Locator":!0},t=baseurl+"/store-locator",a="Please Retry!",n="Oops! there seems to be a technical issue. Please retry with our manual store locator.";"undefined"!=typeof errorMessageCodes[e]&&""!=errorMessageCodes[e]&&("undefined"!=typeof errorMessageCodes[e].msg&&""!=errorMessageCodes[e].msg&&(n=errorMessageCodes[e].msg),"undefined"!=typeof errorMessageCodes[e].title&&""!=errorMessageCodes[e].title&&(a=errorMessageCodes[e].title),"undefined"!=typeof errorMessageCodes[e].btn&&""!=errorMessageCodes[e].btn&&(o=errorMessageCodes[e].btn),errorPrompt(n,t,o,a))}}function singleClickSelect(){if(0==ock){ock=1;var e=document.getElementById("pac-input");return e.select()}return void(ock=0)}function presentlocality(e){var o=!1,t=0,a=0,n=0;return"undefined"!=typeof e&&""!=e&&("undefined"!=typeof e&&""!=e&&$.each(e.address_components.reverse(),function(e,o){(-1!=$.inArray("sublocality_level_1",o.types)||-1!=$.inArray("sublocality_level_2",o.types)||-1!=$.inArray("sublocality_level_3",o.types)||-1!=$.inArray("sublocality_level_4",o.types)||-1!=$.inArray("sublocality_level_5",o.types)||-1!=$.inArray("sublocality_level_4",o.types)||-1!=$.inArray("street_number",o.types)||-1!=$.inArray("route",o.types)||-1!=$.inArray("intersection",o.types)||-1!=$.inArray("neighborhood",o.types)||-1!=$.inArray("premise",o.types)||-1!=$.inArray("subpremise",o.types)||-1!=$.inArray("floor",o.types)||-1!=$.inArray("establishment",o.types)||-1!=$.inArray("room",o.types)||-1!=$.inArray("street_address",o.types))&&(t=1),-1!=$.inArray("sublocality_level_1",o.types)&&(a=1),-1!=$.inArray("sublocality_level_2",o.types)&&(n=1)}),1==t&&"undefined"!=typeof e.types&&(-1!=$.inArray("sublocality_level_2",e.types)||-1!=$.inArray("sublocality_level_3",e.types)||-1!=$.inArray("sublocality_level_4",e.types)||-1!=$.inArray("sublocality_level_5",e.types)||-1!=$.inArray("sublocality_level_4",e.types)||-1!=$.inArray("street_number",e.types)||-1!=$.inArray("intersection",e.types)||-1!=$.inArray("neighborhood",e.types)||-1!=$.inArray("premise",e.types)||-1!=$.inArray("subpremise",e.types)||-1!=$.inArray("floor",e.types)||-1!=$.inArray("establishment",e.types)||-1!=$.inArray("room",e.types)||-1!=$.inArray("street_address",e.types))&&(o=!0),1==o&&0==a&&0==n&&(o=!1)),o}var errorMessageCodes={"00":{title:"Please Retry",msg:"We could not auto detect your location, please select your location manually.",btn:{"Store Locator":!0}},"01":{title:"Couldn’t Find Restaurant",msg:"We could not auto detect your location, please select your location manually.",btn:{"Store Locator":!0}},"02":{title:"Enable Location Services",msg:"Location Detection is disabled. Kindly Enable Location Services under Settings or type in the address.",btn:{OK:!1}},"03":{title:"Can’t Detect Location",msg:"Oops! We couldn’t detect your location. Please type in your address.",btn:{OK:!1}},"04":{title:"Incomplete Address",msg:"Please select Location from Dropdown.",btn:{OK:!1}}},autoDetect=!1,hidePickupButton=0;$(document).ready(function(){$("#custGeoAddress").focus(function(){showPageBlocker(),autoDetect=!1;var e=geoMapHtml(),o=appendSaveAddress(),t='<div class = "recent-geo-search ui-autocomplete ui-front ui-menu ui-widget ui-widget-content" style = "float:left;">',a=0;"undefined"!=typeof o&&""!=o&&(t+='<h4 class="search-heading"> Saved Location </h4>'+o,a=1),"undefined"!=typeof e&&""!=e&&(t+='<h4 class="search-heading"> Recent Search </h4>'+e,a=1),t+="</div>",0!=a&&$(".recent-address").append(t),initAutoSuggest()}),$(document).on("mousedown",".geoSaveAddress",function(){var e=$(this).attr("id"),o=e.split("-");if("undefined"!=typeof saveAddress&&"undefined"!=typeof o&&""!=saveAddress&&""!=o){var t=saveAddress[o[1]];if($("#"+e).hasClass("isGeoAddress")){if("undefined"!=typeof t&&""!=t){var a={selCity:t.city,selLocality:t.city_region,selSubLocality:t.area_level0,selArea1:t.area_level1,selArea2:t.area_level2,houseNo:t.building_number,street:t.street_name,addressType:t.address_type,defaultStore:!1,lat:t.latitude,lon:t.longitude,action:"default"};setStore(a)}}else"undefined"!=typeof t.zippr_code&&""!=t.zippr_code?(zipperSource="primary",getAddressByZippr(t.zippr_code)):checkStoreDetail(t.city,t.city_region,t.area_level0,t.area_level1,t.area_level2,t.building_number,t.street_name,t.address_type,"","default")}}),$(document).on("mousedown",".geoRecentAddress",function(){showPageBlocker();var e=$(this).attr("id"),o=e.split("-");if("undefined"!=typeof GeoCookieValue&&"undefined"!=typeof o&&""!=GeoCookieValue&&""!=o){var t=GeoCookieValue[o[1]],a=t.split("#");geocodePlaceId(a[1],1)}});var e=!1;$(".input-location").focusout(function(o){$(".pac-container").remove(),e=!1}),$(".input-location").focusin(function(o){e=!0}),$(document).click(function(o){return 1==e?(e=!1,!0):void $(".recent-geo-search").remove()}),$(".recent-address").click(function(o){e=!0}),$("#custGeoAddress").keyup(function(){$(".recent-geo-search").remove()}),$(document).on("click",".pickupEdit",function(e){var o="pick-up";changeDelievryMode(o)}),$(document).on("click",".changeDelivery",function(e){var o="";changeDelievryMode(o)}),$("#removeGeoPopupWrap").on("click",function(){$(".addnewadressPopup").popup("hide")}),$(".addressAdd").on("click",function(){$("#saveAddressBtn").attr("disabled","disabled"),$("#pickUpChkBox").hide()}),$(document).on("click","#submitLocation",function(){showPageBlocker();var e=$("#geoGeometry").val();"undefined"!=e&&""!=e&&$("#storeLocatorGeoForm").submit()}),$("#geoBuildOrder").on("click",function(){$("#buildOrderForm").submit()}),$(document).on("click",".guest_user_delivery_address",function(){$("#custGeoAddress").focus()}),"undefined"!=typeof googleLocatorError&&""!==googleLocatorError&&fetchAndShowMessage(googleLocatorError);var o=0;$(window).scroll(function(){$(window).scrollTop()>15&&"block"==$(".menuorderWrap").css("display")?(o++,1==o&&$(".closeSL").trigger("click")):o=0})}),$(".orderGeoSelection").on("click",".radio, label",function(){var e=$("input",$(this).parent()),o=e.val();"undefined"!=typeof o&&""!=o&&changeDelievryMode(o)});var position="";$(document).on("click","#geoLocate",function(){autoDetect=!0,url=baseurl+"",getLocation()}),$(".map_slide_close").on("click",function(){closeMap()}),$(".geoCloseSLDashBorad").on("click",function(){$(".addnewadressPopup").popup("hide")});var ock=0;